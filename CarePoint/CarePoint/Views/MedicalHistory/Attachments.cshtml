@using Extensions
@using DAL
@{
    ViewBag.Title = "Attachements";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{ Citizen user = User.Identity.GetCitizen();}
<div class="container-fluid">
    <ul class="nav nav-pills">
        <li class="active"><a id="itab-analysis" href="#div-analysis-tab" data-toggle="tab">Analysis</a></li>
        <li><a id="itab-radiology" href="#div-radiology-tab" data-toggle="tab">Radiology</a></li>
        <li><a id="itab-other" href="#div-other-tab" data-toggle="tab">Others</a></li>
    </ul>
    <div class="tab-content">
        <div id="idiv-analysis-tab" class="tab-pane fade in active">
            <ul class="list-group">
            @{var analysisAttachments = user.Attachments.Where(attachment => attachment.AttachmentType.Name.Equals("Analysis")); }
            @{var radiolodyAttachments = user.Attachments.Where(attachment => attachment.AttachmentType.Name.Equals("Radiology")); }
            @{var otherAttachments = user.Attachments.Except(analysisAttachments).Except(radiolodyAttachments); }
            @foreach (var attachment in analysisAttachments)
            {
                <li class="list-group-item">
                    <div class="row">
                        <div class="col-md-5">
                            @if (attachment.filePath.EndsWith(".jpg") || attachment.filePath.EndsWith(".png") || attachment.filePath.EndsWith(".bmp") || attachment.filePath.EndsWith(".ico"))
                            {<span class="fa fa-file-image-o fa-fw"></span>}
                            else if (attachment.filePath.EndsWith(".pdf"))
                            {<span class="fa fa-file-pdf-o fa-fw"></span>}
                            else if (attachment.filePath.EndsWith(".docx") || attachment.filePath.EndsWith(".docb") || attachment.filePath.EndsWith(".docm") || attachment.filePath.EndsWith(".dotx") || attachment.filePath.EndsWith(".dotm"))
                            {<span class="fa fa-file-word-o fa-fw"></span>}
                            else
                            {<span class="fa fa-file-alt-o fa-fw"></span>}
                            <a href="@attachment.filePath">@attachment.fileName</a>
                        </div>
                        <div class="col-md-3">@attachment.Specialist.Name</div>
                        <div class="col-md-3">@attachment.Date.Date.ToString("dd/MM/yyyy")</div>
                        <div class="col-md-1"><a id="ilink@{@attachment.ID}-download" href="#"><span class="fa fa-download fa-fw"></span></a></div>
                    </div>
                </li>
             }
            </ul>
        </div>
        <div id="idiv-radiology-tab" class="tab-pane fade">
            <ul class="list-group">
            @foreach (var attachment in radiolodyAttachments)
            {
                <li class="list-group-item">
                    <div class="row">
                        <div class="col-md-5">
                            @if (attachment.filePath.EndsWith(".jpg") || attachment.filePath.EndsWith(".png") || attachment.filePath.EndsWith(".bmp") || attachment.filePath.EndsWith(".ico"))
                            {<span class="fa fa-file-image-o fa-fw"></span>}
                            else if (attachment.filePath.EndsWith(".pdf"))
                            {<span class="fa fa-file-pdf-o fa-fw"></span>}
                            else if (attachment.filePath.EndsWith(".docx") || attachment.filePath.EndsWith(".docb") || attachment.filePath.EndsWith(".docm") || attachment.filePath.EndsWith(".dotx") || attachment.filePath.EndsWith(".dotm"))
                            {<span class="fa fa-file-word-o fa-fw"></span>}
                            else
                            {<span class="fa fa-file-alt-o fa-fw"></span>}
                            <a href="@attachment.filePath">@attachment.fileName</a>
                        </div>
                        <div class="col-md-3">@attachment.Specialist.Name</div>
                        <div class="col-md-3">@attachment.Date.Date.ToString("dd/MM/yyyy")</div>
                        <div class="col-md-1"><a id="ilink@{@attachment.ID}-download" href="#"><span class="fa fa-download fa-fw"></span></a></div>
                    </div>
                </li>
            }
            </ul>
        </div>
        <div id="idiv-other-tab" class="tab-pane fade">
            <ul class="list-group">
                @foreach (var attachment in otherAttachments)
                {
                    <li class="list-group-item">
                        
                        <div class="row">
                            <div class="col-md-5">
                                @if (attachment.filePath.EndsWith(".jpg") || attachment.filePath.EndsWith(".png") || attachment.filePath.EndsWith(".bmp") || attachment.filePath.EndsWith(".ico"))
                                {<span class="fa fa-file-image-o fa-fw"></span>}
                                else if (attachment.filePath.EndsWith(".pdf"))
                                {<span class="fa fa-file-pdf-o fa-fw"></span>}
                                else if (attachment.filePath.EndsWith(".docx") || attachment.filePath.EndsWith(".docb") || attachment.filePath.EndsWith(".docm") || attachment.filePath.EndsWith(".dotx") || attachment.filePath.EndsWith(".dotm"))
                                {<span class="fa fa-file-word-o fa-fw"></span>}
                                else
                                {<span class="fa fa-file-alt-o fa-fw"></span>}
                                <a href="@attachment.filePath">@attachment.fileName</a>
                            </div>
                            <div class="col-md-3">@attachment.Specialist.Name</div>
                            <div class="col-md-3">@attachment.Date.Date.ToString("dd/MM/yyyy")</div>
                            <div class="col-md-1"><a id="ilink@{@attachment.ID}-download" href="#"><span class="fa fa-download fa-fw"></span></a></div>
                        </div>
                    </li>
                }
            </ul>
        </div>
    </div>
</div>

